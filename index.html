<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Sistema Escolar - Moreira e Silva</title>

<style>
body { font-family: Arial; background:#f4f6f9; margin:0; }
header { background:#1e3a8a; color:white; padding:15px; text-align:center; }
.container { padding:20px; }
input, select, button { padding:8px; margin:5px; }
button { background:#2563eb; color:white; border:none; cursor:pointer; }
button:hover { background:#1d4ed8; }
.card { background:white; padding:20px; margin-top:15px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
table { width:100%; border-collapse:collapse; margin-top:10px; }
table, th, td { border:1px solid #ccc; }
th, td { padding:8px; text-align:center; }
.hidden { display:none; }
</style>
</head>

<body>

<header>
<h1>Sistema Escolar - Escola Moreira e Silva</h1>
</header>

<div class="container">

<!-- LOGIN -->
<div id="login" class="card">
<h2>Login</h2>
<input type="text" id="usuario" placeholder="Usuário">
<input type="password" id="senha" placeholder="Senha">
<button onclick="entrar()">Entrar</button>
<p id="erroLogin" style="color:red;"></p>
</div>

<!-- SISTEMA -->
<div id="sistema" class="hidden">

<div class="card">
<h2>Cadastrar Turma</h2>
<input type="text" id="novaTurma" placeholder="Nome da turma">
<button onclick="criarTurma()">Criar Turma</button>
</div>

<div class="card">
<h2>Cadastrar Aluno</h2>
<select id="turmaSelect"></select>
<input type="text" id="nome" placeholder="Nome do aluno">
<input type="number" id="nota1" placeholder="Nota 1">
<input type="number" id="nota2" placeholder="Nota 2">
<button onclick="adicionarAluno()">Adicionar</button>
</div>

<div class="card">
<h2>Painel da Direção</h2>
<select id="filtroTurma" onchange="renderTabela()"></select>
<table id="tabela">
<tr>
<th>Turma</th>
<th>Nome</th>
<th>Média</th>
<th>Situação</th>
<th>Ação</th>
</tr>
</table>
</div>

</div>
</div>

<script>

let dados = JSON.parse(localStorage.getItem("dados")) || { turmas: [], alunos: [] };

function salvar() {
    localStorage.setItem("dados", JSON.stringify(dados));
}

function entrar() {
    let usuario = document.getElementById("usuario").value;
    let senha = document.getElementById("senha").value;

    if (usuario === "admin" && senha === "1234") {
        document.getElementById("login").classList.add("hidden");
        document.getElementById("sistema").classList.remove("hidden");
        atualizarSelects();
        renderTabela();
    } else {
        document.getElementById("erroLogin").innerText = "Login incorreto!";
    }
}

function criarTurma() {
    let nome = document.getElementById("novaTurma").value;
    if (!nome) return alert("Digite o nome da turma");

    dados.turmas.push(nome);
    salvar();
    atualizarSelects();
    document.getElementById("novaTurma").value = "";
}

function atualizarSelects() {
    let selects = ["turmaSelect", "filtroTurma"];
    selects.forEach(id => {
        let select = document.getElementById(id);
        select.innerHTML = "";
        dados.turmas.forEach(t => {
            let option = document.createElement("option");
            option.value = t;
            option.textContent = t;
            select.appendChild(option);
        });
    });
}

function adicionarAluno() {
    let turma = document.getElementById("turmaSelect").value;
    let nome = document.getElementById("nome").value;
    let nota1 = parseFloat(document.getElementById("nota1").value);
    let nota2 = parseFloat(document.getElementById("nota2").value);

    if (!turma || !nome || isNaN(nota1) || isNaN(nota2))
        return alert("Preencha todos os campos");

    let media = (nota1 + nota2) / 2;
    let situacao = media >= 7 ? "Aprovado" :
                   media >= 5 ? "Recuperação" :
                   "Reprovado";

    dados.alunos.push({ turma, nome, media: media.toFixed(1), situacao });
    salvar();
    renderTabela();

    document.getElementById("nome").value = "";
    document.getElementById("nota1").value = "";
    document.getElementById("nota2").value = "";
}

function renderTabela() {
    let tabela = document.getElementById("tabela");
    tabela.innerHTML = `
    <tr>
        <th>Turma</th>
        <th>Nome</th>
        <th>Média</th>
        <th>Situação</th>
        <th>Ação</th>
    </tr>`;

    let filtro = document.getElementById("filtroTurma").value;

    dados.alunos
        .filter(a => !filtro || a.turma === filtro)
        .forEach((a, index) => {
            let row = tabela.insertRow();
            row.insertCell(0).innerText = a.turma;
            row.insertCell(1).innerText = a.nome;
            row.insertCell(2).innerText = a.media;
            row.insertCell(3).innerText = a.situacao;
            row.insertCell(4).innerHTML =
                `<button onclick="removerAluno(${index})">Excluir</button>`;
        });
}

function removerAluno(index) {
    dados.alunos.splice(index, 1);
    salvar();
    renderTabela();
}

</script>

</body>
</html>
